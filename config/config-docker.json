{
  "port": 8080,
  "defaults": {
    "realm": "not-production",
    "branch": "develop",
    "commit": "HEAD"
  },
  "realms": {
    "production": {
      "repository": "quay.io/"
    },
    "not-production": {
      "repository": "quay.io/"
    },
    "totem-development": {
      "repository": "quay.io/"
    },
    "local": {
      "repository": "registry.totem.local/"
    },      
    "public": {
      "repository": ""
    }
  },
  "tasks": {
    "clone": {
      "cmd": "git clone --depth 50 --recurse-submodules --branch {{branch}} git@github.com:{{owner}}/{{repo}}.git ./",
      "timeout": "900000",
      "retries": 1,
      "retryWait": 10000
    },
    "checkout": {
      "cmd": "git checkout -f {{commit}} && update-git-ts.sh",
      "timeout": "120000",
      "retries": 0
    },
    "build": {
      "cmd": "docker build --rm -t {{dockerRepo}}totem/{{owner}}-{{repo}}:{{tag}} ./",
      "timeout": "1800000",
      "retries": 0
    },
    "push": {
      "cmd": "docker push {{dockerRepo}}totem/{{owner}}-{{repo}}:{{tag}}",
      "timeout": "1800000",
      "retries": 20,
      "retryWait": 20000
    }
  },
  "swf":{
    "region": "us-west-1",
    "defaultTasklist": "build-image-list"
  }
}
